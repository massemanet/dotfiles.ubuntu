#!/bin/bash

command -v sudo || su root -c "apt install -y sudo"
groups | grep -q sudo || su root -c "adduser $USER sudo"

S=/etc/apt/sources.list
grep -qE ' main$' "$S" && sudo sed -i 's/ main$/ main contrib non-free/g' "$S"

sudo apt-get update && \
sudo apt-get upgrade -y && \
sudo apt-get install --autoremove -y \
     automake \
     curl \
     deborphan \
     feh \
     g++ git gopass \
     jq \
     kitty \
     linux-firmware lksctp-tools \
     make mosh \
     ncdu netcat-traditional \
     pass pavucontrol powertop python-is-python3 pulseaudio-module-bluetooth \
     ripgrep \
     shellcheck shellinabox
sudo apt purge --autoremove snapd

# get my stuff
[ ! -e ~/.git ] &&
    cd /tmp && \
        rm -rf dotfiles.ubuntu && \
        git clone https://github.com/massemanet/dotfiles.ubuntu && \
        cd dotfiles.ubuntu && \
        git remote set-url origin git@github.com:massemanet/dotfiles.ubuntu && \
        mv /tmp/dotfiles.ubuntu/.git ~ && \
        (cd && git reset --hard)

~/bin/pet unpack

exit 0
~/bin/install.sh chromium
~/bin/install.sh keybase
~/bin/install.sh spotify
~/bin/install.sh sway
~/bin/install.sh emacs
exit 0
~/bin/install.sh aws-vault
~/bin/install.sh awscli
~/bin/install.sh bazel
~/bin/install.sh bazelisk
~/bin/install.sh docker
~/bin/install.sh kubectl
~/bin/install.sh wireshark
~/bin/install.sh erlang
